{% extends 'base.html' %}
{% block content %}
<article class="glass rounded-3xl p-8 border border-white/20 mb-8">
  <h1 class="text-2xl md:text-3xl font-extrabold mb-2">{{ thread['title'] }}</h1>
  <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Por <strong>{{ thread['author'] }}</strong> · {{ thread['created_at'] }}</p>
  <div class="prose dark:prose-invert max-w-none">{{ thread['content'] }}</div>
  {% if session['user'] == thread['author'] or session['user'] == 'admin' %}
    <div class="mt-6 flex gap-2">
      {% if session['user'] == thread['author'] %}
        <a href="{{ url_for('edit_thread', id=thread['id']) }}" class="px-4 py-2 rounded-xl bg-amber-500 text-white lift">Editar</a>
      {% endif %}
      <a href="{{ url_for('delete_thread', id=thread['id']) if session['user'] == thread['author'] else url_for('admin_delete_thread', thread_id=thread['id']) }}" 
         class="px-4 py-2 rounded-xl bg-rose-600 text-white lift" 
         onclick="return confirm('¿Eliminar este hilo y todas sus respuestas?');">Eliminar</a>
    </div>
  {% endif %}
</article>
<section class="mb-8">
  <h2 class="text-xl font-bold mb-3">Respuestas</h2>
  <div class="space-y-3">
    {% for reply in replies %}
      <div class="glass rounded-xl p-4 border border-white/20 flex items-start justify-between">
        <div>
          <p class="text-sm text-slate-500 dark:text-slate-400 mb-1">{{ reply['author'] }} · {{ reply['created_at'] }}</p>
          <p>{{ reply['content'] }}</p>
        </div>
        {% if session['user'] == reply['author'] %}
          <a href="{{ url_for('delete_reply', id=reply['id']) }}" class="text-rose-500 hover:underline" onclick="return confirm('¿Eliminar respuesta?');">Eliminar</a>
        {% endif %}
      </div>
    {% else %}
      <p class="text-slate-600 dark:text-slate-300">No hay respuestas todavía.</p>
    {% endfor %}
  </div>
</section>
<form method="post" class="glass rounded-2xl p-6 border border-white/20 space-y-3" data-hotkey="submit">
  <label class="block text-sm">Nueva respuesta</label>
  <textarea name="content" rows="4" required class="w-full px-4 py-3 rounded-xl border border-slate-300/70 dark:border-white/10 bg-white/80 dark:bg-white/5 focus-glow" placeholder="Escribe tu respuesta..."></textarea>
  <button class="px-5 py-3 rounded-xl font-bold text-white bg-gradient-to-r from-indigo-600 to-purple-600 lift">Responder (Ctrl+Enter)</button>
</form>
{% endblock %}
